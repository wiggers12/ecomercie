<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cat√°logo Moderno - Ecomercie</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>

    <style>
        /* Seu CSS original permanece, com adi√ß√µes para o modal e carrinho */
        :root {
            --cor-primaria: #007BFF;
            --cor-secundaria: #1a3d5f;
            --cor-sucesso: #28a745;
            --cor-perigo: #dc3545;
            --cor-fundo: #f4f6f9;
            --cor-texto: #333;
            --cor-branca: #ffffff;
            --sombra-suave: 0 4px 12px rgba(0, 0, 0, 0.08);
            --border-radius: 10px;
            --font-principal: 'Poppins', sans-serif;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: var(--font-principal); background-color: var(--cor-fundo); color: var(--cor-texto); }
        header { background-color: var(--cor-branca); padding: 20px 5%; box-shadow: var(--sombra-suave); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px; position: sticky; top: 0; z-index: 1000; }
        h1 { font-size: 1.8em; color: var(--cor-primaria); font-weight: 700; }
        .search-container { flex-grow: 1; max-width: 500px; }
        #search-input { width: 100%; padding: 12px 20px; border: 1px solid #ddd; border-radius: var(--border-radius); font-size: 16px; font-family: var(--font-principal); }
        main { padding: 30px 5%; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 25px; }
        .card { background: var(--cor-branca); border-radius: var(--border-radius); box-shadow: var(--sombra-suave); transition: transform 0.3s ease, box-shadow 0.3s ease; overflow: hidden; display: flex; flex-direction: column; cursor: pointer; }
        .card:hover { transform: translateY(-8px); box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12); }
        .card img { width: 100%; height: 180px; object-fit: cover; }
        .card-content { padding: 15px; display: flex; flex-direction: column; flex-grow: 1; }
        .card h3 { font-size: 1.1em; font-weight: 600; margin-bottom: 5px; }
        .card .price { font-size: 1.3em; font-weight: 700; color: var(--cor-primaria); margin: auto 0 15px 0; }
        .add-to-cart-btn { background-color: var(--cor-primaria); color: var(--cor-branca); border: none; padding: 10px; border-radius: var(--border-radius); cursor: pointer; font-size: 1em; font-weight: 500; transition: background-color 0.3s; z-index: 2; /* Para ficar clic√°vel acima do card */ }
        .add-to-cart-btn:hover { background-color: var(--cor-secundaria); }
        
        /* CARRINHO - MELHORIAS DE QUANTIDADE */
        .cart-icon { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; background-color: var(--cor-primaria); color: var(--cor-branca); border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 28px; cursor: pointer; box-shadow: 0 4px 15px rgba(0, 123, 255, 0.4); z-index: 1010; }
        .cart-count { position: absolute; top: -5px; right: -5px; background-color: var(--cor-perigo); color: var(--cor-branca); font-size: 12px; width: 22px; height: 22px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-weight: 600; }
        .cart-sidebar { position: fixed; top: 0; right: -100%; width: 100%; max-width: 400px; height: 100%; background-color: var(--cor-branca); box-shadow: -5px 0 20px rgba(0,0,0,0.15); transition: right 0.4s ease-in-out; z-index: 1020; display: flex; flex-direction: column; }
        .cart-sidebar.open { right: 0; }
        .cart-header { padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        .cart-header h2 { font-size: 1.5em; }
        .close-cart-btn { font-size: 2em; cursor: pointer; background: none; border: none; }
        #cart-items { flex-grow: 1; overflow-y: auto; padding: 20px; }
        .cart-item { display: flex; align-items: center; margin-bottom: 20px; }
        .cart-item img { width: 80px; height: 80px; object-fit: cover; border-radius: var(--border-radius); margin-right: 15px; }
        .cart-item-info { flex-grow: 1; }
        .cart-item-info h4 { margin-bottom: 5px; }
        .cart-item-info p { color: var(--cor-primaria); font-weight: 600; margin-bottom: 8px; }
        .quantity-control { display: flex; align-items: center; gap: 8px; }
        .quantity-btn { width: 24px; height: 24px; border: 1px solid #ddd; background: #f9f9f9; cursor: pointer; font-size: 16px; }
        .remove-item-btn { margin-left: auto; color: var(--cor-perigo); background: none; border: none; font-size: 1.5em; cursor: pointer; }
        .cart-footer { padding: 20px; border-top: 1px solid #eee; }
        .cart-total { display: flex; justify-content: space-between; font-size: 1.2em; font-weight: 600; margin-bottom: 15px; }
        .checkout-btn { width: 100%; padding: 15px; background-color: var(--cor-sucesso); color: var(--cor-branca); border: none; border-radius: var(--border-radius); font-size: 1.1em; font-weight: 600; cursor: pointer; }
        .social-buttons { position: fixed; top: 50%; left: 0; transform: translateY(-50%); z-index: 1000; display: flex; flex-direction: column; gap: 5px; }
        .social-btn { width: 45px; height: 45px; display: flex; justify-content: center; align-items: center; color: var(--cor-branca); font-size: 24px; text-decoration: none; border-top-right-radius: var(--border-radius); border-bottom-right-radius: var(--border-radius); transition: transform 0.3s ease; }
        .social-btn:hover { transform: translateX(5px); }
        .whatsapp { background-color: #25D366; }
        .instagram { background: radial-gradient(circle at 30% 107%, #fdf497 0%, #fdf497 5%, #fd5949 45%,#d6249f 60%,#285AEB 90%); }
        .facebook { background-color: #1877F2; }

        /* NOVO: ESTILOS PARA O MODAL DE DETALHES DO PRODUTO */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(17, 24, 39, 0.6); z-index: 2000; display: none; justify-content: center; align-items: center; backdrop-filter: blur(4px); }
        .modal-content { background: #fff; padding: 24px; border-radius: 12px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-header h2 { margin: 0; }
        .modal-close { font-size: 2em; cursor: pointer; background: none; border: none; }
        #modal-image { width: 100%; height: 250px; object-fit: cover; border-radius: var(--border-radius); margin-bottom: 15px; }
        #modal-price { font-size: 1.8em; font-weight: 700; color: var(--cor-primaria); margin-bottom: 15px; }
        #modal-description { margin-bottom: 20px; }
        
    </style>
</head>
<body>

    <header>
        <h1>Meu Cat√°logo</h1>
        <div class="search-container">
            <input type="text" id="search-input" placeholder="O que voc√™ est√° procurando?">
        </div>
    </header>

    <main>
        <div class="grid" id="product-grid">
            <p>Carregando produtos...</p>
        </div>
    </main>
    
    <div class="social-buttons"></div>
    <div class="cart-icon" id="cart-icon">üõí<span class="cart-count" id="cart-count">0</span></div>
    <div class="cart-sidebar" id="cart-sidebar"></div>

    <div class="modal-overlay" id="product-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title"></h2>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            <img id="modal-image" src="" alt="Imagem do Produto">
            <p id="modal-price"></p>
            <p id="modal-description"></p>
            <button class="add-to-cart-btn" id="modal-add-to-cart-btn">Adicionar</button>
        </div>
    </div>

    <script type="text/javascript">
        // Cole seu script do Tawk.to aqui
    </script>
    <script>
    // --- IN√çCIO: CONFIGURA√á√ÉO E L√ìGICA DO FIREBASE ---
    // COLE SEU OBJETO firebaseConfig AQUI
    const firebaseConfig = {
      apiKey: "AIza...",
      authDomain: "seu-projeto.firebaseapp.com",
      // ...resto das suas chaves
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    
    document.addEventListener('DOMContentLoaded', () => {
        let allProducts = []; // Armazena todos os produtos do Firebase
        let cart = JSON.parse(localStorage.getItem('cart')) || []; // Carrega o carrinho do localStorage

        const productGrid = document.getElementById('product-grid');
        const searchInput = document.getElementById('search-input');
        // ... (outros elementos do DOM para o carrinho)
        
        // --- L√ìGICA DE PRODUTOS ---
        async function fetchProducts() {
            try {
                const snapshot = await db.collection('products').get();
                allProducts = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderProducts(allProducts);
            } catch (error) {
                console.error("Erro ao buscar produtos: ", error);
                productGrid.innerHTML = '<p>N√£o foi poss√≠vel carregar os produtos.</p>';
            }
        }

        function renderProducts(productsToRender) {
            productGrid.innerHTML = '';
            if (productsToRender.length === 0) {
                productGrid.innerHTML = '<p>Nenhum produto encontrado.</p>';
                return;
            }
            productsToRender.forEach(product => {
                const card = document.createElement('div');
                card.className = 'card';
                card.dataset.id = product.id;
                card.innerHTML = `
                    <img src="${product.imageUrl || 'https://via.placeholder.com/220x180'}" alt="${product.name}">
                    <div class="card-content">
                        <h3>${product.name}</h3>
                        <p class="price">R$ ${product.price.toFixed(2).replace('.', ',')}</p>
                        <button class="add-to-cart-btn" data-id="${product.id}">Adicionar</button>
                    </div>`;
                productGrid.appendChild(card);
            });
        }

        // --- L√ìGICA DO CARRINHO (APRIMORADA) ---
        function saveCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        function updateCartDisplay() {
            const cartItemsContainer = document.getElementById('cart-items');
            cartItemsContainer.innerHTML = '';
            // ... (l√≥gica para exibir itens com controle de quantidade, e o total)
            // ... (atualizar cartCount)
            saveCart();
        }
        
        function addToCart(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) return;

            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            updateCartDisplay();
            // Abre o carrinho para mostrar o item adicionado
            document.getElementById('cart-sidebar').classList.add('open');
        }

        function updateQuantity(productId, newQuantity) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                if (newQuantity > 0) {
                    item.quantity = newQuantity;
                } else {
                    removeFromCart(productId);
                }
                updateCartDisplay();
            }
        }
        
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartDisplay();
        }

        // --- L√ìGICA DO MODAL ---
        function openProductModal(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) return;
            // Preenche e exibe o modal...
        }
        
        // --- EVENT LISTENERS ---
        searchInput.addEventListener('input', () => {
            const searchTerm = searchInput.value.toLowerCase();
            const filteredProducts = allProducts.filter(p => p.name.toLowerCase().includes(searchTerm));
            renderProducts(filteredProducts);
        });

        productGrid.addEventListener('click', (e) => {
            const card = e.target.closest('.card');
            if (!card) return;
            const productId = card.dataset.id;
            
            if (e.target.classList.contains('add-to-cart-btn')) {
                e.stopPropagation(); // Impede que o modal abra ao clicar no bot√£o
                addToCart(productId);
            } else {
                openProductModal(productId);
            }
        });

        // ... (outros event listeners para o carrinho e modal)

        // --- INICIALIZA√á√ÉO ---
        fetchProducts(); // Busca os produtos do Firebase
        updateCartDisplay(); // Mostra o carrinho salvo
    });
    </script>
</body>
</html>
